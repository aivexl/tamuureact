
name = "tamuu-api-enhanced"
main = "tamuu-api-worker-enhanced.js"
compatibility_date = "2024-01-27"
workers_dev = true

# Custom domain routing for production API (CRITICAL: routes to api.tamuu.id)
# Note: Custom domains in Cloudflare don't use wildcards or paths - just the domain
[[routes]]
pattern = "api.tamuu.id"
zone_id = "" # Auto-filled by Cloudflare
custom_domain = true

# Environment Variables Configuration
# NEVER commit actual values - use wrangler secret commands

[env.production]
name = "tamuu-api-prod"
route = { pattern = "api.tamuu.id", zone_id = "", custom_domain = true }

# Development environment
[env.development]
name = "tamuu-api-dev"

# Staging environment
[env.staging]
name = "tamuu-api-staging"

# Secrets Management Commands:
# wrangler secret put GEMINI_API_KEY --env production
# wrangler secret put DATABASE_URL --env production
# wrangler secret put JWT_SECRET --env production
# wrangler secret put ENCRYPTION_KEY --env production

# KV Namespaces (if needed)
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your_kv_namespace_id"
# preview_id = "your_preview_kv_namespace_id"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "tamuu-db"
database_id = "cb0a336d-c070-49e6-80d4-c198a2df141d"

# R2 Storage
[[r2_buckets]]
binding = "ASSETS"
bucket_name = "tamuu-assets"

# AI Model Configuration
[ai]
binding = "AI"

# Analytics Engine
# [[analytics_engine_datasets]]
# binding = "ANALYTICS"
# dataset = "tamuu-analytics"

# Environment-specific configurations
[env.production.vars]
ENVIRONMENT = "production"
DEBUG = "false"
LOG_LEVEL = "info"

[env.development.vars]
ENVIRONMENT = "development"
DEBUG = "true"
LOG_LEVEL = "debug"

[env.staging.vars]
ENVIRONMENT = "staging"
DEBUG = "false"
LOG_LEVEL = "info"
